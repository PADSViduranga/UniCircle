<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Leader Dashboard | UniCircle</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <style>
        .stat-card { transition: transform 0.2s; cursor: pointer; border: none; border-radius: 15px; }
        .stat-card:hover { transform: translateY(-5px); }
        .icon-box { width: 50px; height: 50px; border-radius: 10px; display: flex; align-items: center; justify-content: center; }
    </style>
</head>
<body class="bg-light">

<nav class="navbar navbar-dark bg-dark mb-4">
    <div class="container">
        <a class="btn btn-outline-light btn-sm me-3" href="/leader/dashboard">
            <i class="bi bi-arrow-left"></i> All My Clubs
        </a>
        <span class="navbar-brand fw-bold" th:text="${club.name}">Club Name</span>
    </div>
</nav>

<div class="container" th:if="${club != null}">

    <div class="row g-4 mb-5">
        <div class="col-md-4">
            <div class="card stat-card p-3 shadow-sm" onclick="showSection('memberSection')">
                <div class="d-flex align-items-center">
                    <div class="icon-box bg-primary-subtle text-primary me-3"><i class="bi bi-people"></i></div>
                    <div>
                        <h6 class="text-muted mb-0 small">Member Requests</h6>
                        <h4 class="fw-bold mb-0" th:text="${#lists.size(pendingRequests)}">0</h4>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-4">
            <div class="card stat-card p-3 shadow-sm" onclick="showSection('eventSection')">
                <div class="d-flex align-items-center">
                    <div class="icon-box bg-success-subtle text-success me-3"><i class="bi bi-megaphone"></i></div>
                    <div>
                        <h6 class="text-muted mb-0 small">Announcements</h6>
                        <h4 class="fw-bold mb-0">Post Update</h4>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-4">
            <div class="card stat-card p-3 shadow-sm">
                <div class="d-flex align-items-center">
                    <div class="icon-box bg-warning-subtle text-warning me-3"><i class="bi bi-trophy"></i></div>
                    <div>
                        <h6 class="text-muted mb-0 small">Approved Members</h6>
                        <h4 class="fw-bold mb-0" th:text="${approvedCount}">0</h4>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="memberSection" class="content-section">
        <div class="card border-0 shadow-sm rounded-4 overflow-hidden">
            <div class="card-header bg-white py-3 fw-bold border-bottom">
                <i class="bi bi-person-check me-2 text-success"></i>Pending Requests
            </div>
            <div class="table-responsive">
                <table class="table align-middle mb-0">
                    <thead class="table-light">
                    <tr><th>Student</th><th class="text-end px-4">Actions</th></tr>
                    </thead>
                    <tbody>
                    <tr th:each="member : ${pendingRequests}">
                        <td class="fw-bold py-3 px-3" th:text="${member.user.username}">User</td>
                        <td class="text-end px-4">
                            <form th:action="@{/leader/approve/{id}(id=${member.id})}" method="post" class="d-inline">
                                <button class="btn btn-success btn-sm rounded-pill px-3 me-1">Approve</button>
                            </form>
                            <form th:action="@{/leader/reject-member/{id}(id=${member.id})}" method="post" class="d-inline">
                                <button class="btn btn-outline-danger btn-sm rounded-pill px-3">Reject</button>
                            </form>
                        </td>
                    </tr>
                    <tr th:if="${#lists.isEmpty(pendingRequests)}">
                        <td colspan="2" class="text-center py-5 text-muted">No pending requests for this club.</td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div id="eventSection" class="content-section d-none">
        <div class="card border-0 shadow-sm p-5 text-center rounded-4">
            <i class="bi bi-megaphone text-success mb-3" style="font-size: 3rem;"></i>
            <h4>Post Announcement</h4>
            <p class="text-muted">Post a message that will appear on the main Notice Board.</p>
            <a th:href="@{/announcements/new(clubId=${club.id})}" class="btn btn-success btn-lg rounded-pill px-5 shadow-sm">
                Create Post
            </a>
        </div>
    </div>

</div>

<script>
    function showSection(sectionId) {
        document.querySelectorAll('.content-section').forEach(section => {
            section.classList.add('d-none');
        });
        document.getElementById(sectionId).classList.remove('d-none');
    }
</script>
</body>
</html>